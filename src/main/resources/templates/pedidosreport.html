<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Informe de Ganancias</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://kit.fontawesome.com/9d72cb34f3.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.2.1/dist/chart.umd.min.js"></script>
    </head>
    <body>
        <div th:replace="~{navbar.html}"></div>
        <div class="container">
            <!-- Informe de Pedidos Diarios -->
            <div class="my-5">
                <h2>Informe de Pedidos Diarios</h2>
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Cantidad de Pedidos</th>
                            <th>Ganancias Totales</th>
                            <th>Promedio de Ganancias</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Utiliza Thymeleaf para iterar sobre el mapa de pedidos diarios -->
                        <tr th:each="entry : ${pedidosDiarios}">
                            <td th:text="${entry.key}"></td>
                            <td th:text="${entry.value.cantidadPedidos}"></td>
                            <td th:text="${#numbers.formatDecimal(entry.value.gananciasTotales, 0, 'COMMA', 2, 'POINT')}"></td>
                            <td th:text="${#numbers.formatDecimal(entry.value.promedioGanancias, 0, 'COMMA', 2, 'POINT')}"></td>
                        </tr>
                    </tbody>
                </table>
                <div class="chart-container">
                    <canvas id="chartPedidosDiarios"></canvas>
                </div>
            </div>

            <!-- Informe de Pedidos Semanales -->
            <div class="my-5">
                <h2>Informe de Pedidos Semanales</h2>
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Semana</th>
                            <th>Cantidad de Pedidos</th>
                            <th>Ganancias Totales</th>
                            <th>Promedio de Ganancias</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Utiliza Thymeleaf para iterar sobre el mapa de pedidos semanales -->
                        <tr th:each="entry : ${pedidosSemanales}">
                            <td th:text="${entry.key}"></td>
                            <td th:text="${entry.value.cantidadPedidos}"></td>
                            <td th:text="${#numbers.formatDecimal(entry.value.gananciasTotales, 0, 'COMMA', 2, 'POINT')}"></td>
                            <td th:text="${#numbers.formatDecimal(entry.value.promedioGanancias, 0, 'COMMA', 2, 'POINT')}"></td>
                        </tr>
                    </tbody>
                </table>
                <div class="chart-container">
                    <canvas id="chartPedidosSemanales"></canvas>
                </div>
            </div>

            <!-- Informe de Pedidos Mensuales -->
            <div class="my-5">
                <h2>Informe de Pedidos Mensuales</h2>
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Mes</th>
                            <th>Cantidad de Pedidos</th>
                            <th>Ganancias Totales</th>
                            <th>Promedio de Ganancias</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Utiliza Thymeleaf para iterar sobre el mapa de pedidos mensuales -->
                        <tr th:each="entry : ${pedidosMensuales}">
                            <td th:text="${entry.key}"></td>
                            <td th:text="${entry.value.cantidadPedidos}"></td>
                            <td th:text="${#numbers.formatDecimal(entry.value.gananciasTotales, 0, 'COMMA', 2, 'POINT')}"></td>
                            <td th:text="${#numbers.formatDecimal(entry.value.promedioGanancias, 0, 'COMMA', 2, 'POINT')}"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <script th:inline="javascript">
            // Obtener los datos de los pedidos diarios y semanales desde Thymeleaf
            var pedidosDiarios = /*[[${pedidosDiarios}]]*/ {};
            var pedidosSemanales = /*[[${pedidosSemanales}]]*/ {};

            // Crear el gráfico de pedidos diarios
            var ctxPedidosDiarios = document.getElementById('chartPedidosDiarios').getContext('2d');
            new Chart(ctxPedidosDiarios, {
                type: 'line',
                data: {
                    labels: Object.keys(pedidosDiarios),
                    datasets: [{
                        label: 'Pedidos Diarios',
                        data: Object.values(pedidosDiarios).map(entry => entry.cantidadPedidos),
                        backgroundColor: 'rgba(0, 123, 255, 0.5)',
                        borderColor: 'rgba(0, 123, 255, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                    // ... otras opciones de configuración del gráfico
                }
            });

            // Crear el gráfico de pedidos semanales
            var ctxPedidosSemanales = document.getElementById('chartPedidosSemanales').getContext('2d');
            new Chart(ctxPedidosSemanales, {
                type: 'line',
                data: {
                    labels: Object.keys(pedidosSemanales),
                    datasets: [{
                        label: 'Pedidos Semanales',
                        data: Object.values(pedidosSemanales).map(entry => entry.cantidadPedidos),
                        backgroundColor: 'rgba(255, 99, 132, 0.5)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                    // ... otras opciones de configuración del gráfico
                }
            });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js" integrity="sha384-zYPOMqeu1DAVkHiLqWBUTcbYfZ8osu1Nd6Z89ify25QV9guujx43ITvfi12/QExE" crossorigin="anonymous"></script>
    </body>
</html>
